/*
  @library      XRegExp
  @version      1.5.0
  @author       Steven Levithan
  @copyright    Copyright (c) 2007-2010
  @website      http://xregexp.com
  
  Provides an augmented, extensible, cross-browser implementation of regular expressions,
  including support for additional syntax, flags, and methods
  
  MIT License
*/
var XRegExp;if(XRegExp){throw Error("can't load XRegExp twice in the same frame");}(function(){XRegExp=function(b,c){var e=[],f=XRegExp.OUTSIDE_CLASS,d=0,g,h,k,j,l;if(XRegExp.isRegExp(b)){if(c!==undefined)throw TypeError("can't supply flags when constructing one RegExp from another");return m(b)}if(n)throw Error("can't call the XRegExp constructor within token definition functions");c=c||"";g={hasNamedCapture:false,captureNames:[],hasFlag:function(a){return c.indexOf(a)>-1},setFlag:function(a){c+=a}};while(d<b.length){h=w(b,d,f,g);if(h){e.push(h.output);d+=(h.match[0].length||1)}else{if(k=i.exec.call(o[f],b.slice(d))){e.push(k[0]);d+=k[0].length}else{j=b.charAt(d);if(j==="[")f=XRegExp.INSIDE_CLASS;else if(j==="]")f=XRegExp.OUTSIDE_CLASS;e.push(j);d++}}}l=RegExp(e.join(""),i.replace.call(c,x,""));l._0={source:b,captureNames:g.hasNamedCapture?g.captureNames:null};return l};XRegExp.version="1.5.0";XRegExp.INSIDE_CLASS=1;XRegExp.OUTSIDE_CLASS=2;var y=/\$(?:(\d\d?|[$&`'])|{([$\w]+)})/g,x=/[^gimy]+|([\s\S])(?=[\s\S]*\1)/g,r=/^(?:[?*+]|{\d+(?:,\d*)?})\??/,n=false,p=[],i={exec:RegExp.prototype.exec,test:RegExp.prototype.test,match:String.prototype.match,replace:String.prototype.replace,split:String.prototype.split},z=i.exec.call(/()??/,"")[1]===undefined,s=function(){var a=/^/g;i.test.call(a,"");return!a.lastIndex}(),A=function(){var a=/x/g;i.replace.call("x",a,"");return!a.lastIndex}(),t=RegExp.prototype.sticky!==undefined,o={};o[XRegExp.INSIDE_CLASS]=/^(?:\\(?:[0-3][0-7]{0,2}|[4-7][0-7]?|x[\dA-Fa-f]{2}|u[\dA-Fa-f]{4}|c[A-Za-z]|[\s\S]))/;o[XRegExp.OUTSIDE_CLASS]=/^(?:\\(?:0(?:[0-3][0-7]{0,2}|[4-7][0-7]?)?|[1-9]\d*|x[\dA-Fa-f]{2}|u[\dA-Fa-f]{4}|c[A-Za-z]|[\s\S])|\(\?[:=!]|[?*+]\?|{\d+(?:,\d*)?}\??)/;XRegExp.addToken=function(a,b,c,e){p.push({pattern:m(a,"g"+(t?"y":"")),handler:b,scope:c||XRegExp.OUTSIDE_CLASS,trigger:e||null})};XRegExp.cache=function(a,b){var c=a+"/"+(b||"");return XRegExp.cache[c]||(XRegExp.cache[c]=XRegExp(a,b))};XRegExp.copyAsGlobal=function(a){return m(a,"g")};XRegExp.escape=function(a){return a.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")};XRegExp.execAt=function(a,b,c,e){b=m(b,"g"+((e&&t)?"y":""));b.lastIndex=c=c||0;var f=b.exec(a);if(e)return(f&&f.index===c)?f:null;else return f};XRegExp.freezeTokens=function(){XRegExp.addToken=function(){throw Error("can't run addToken after freezeTokens");}};XRegExp.isRegExp=function(a){return Object.prototype.toString.call(a)==="[object RegExp]"};XRegExp.iterate=function(a,b,c,e){var f=m(b,"g"),d=-1,g;while(g=f.exec(a)){c.call(e,g,++d,a,f);if(f.lastIndex===g.index)f.lastIndex++}if(b.global)b.lastIndex=0};XRegExp.matchChain=function(h,k){return function j(b,c){var e=k[c].regex?k[c]:{regex:k[c]},f=m(e.regex,"g"),d=[],g;for(g=0;g<b.length;g++){XRegExp.iterate(b[g],f,function(a){d.push(e.backref?(a[e.backref]||""):a[0])})}return((c===k.length-1)||!d.length)?d:j(d,c+1)}([h],0)};RegExp.prototype.apply=function(a,b){return this.exec(b[0])};RegExp.prototype.call=function(a,b){return this.exec(b)};RegExp.prototype.exec=function(b){var c=i.exec.apply(this,arguments),e,f;if(c){if(!z&&c.length>1&&q(c,"")>-1){f=RegExp(this.source,i.replace.call(u(this),"g",""));i.replace.call(b.slice(c.index),f,function(){for(var a=1;a<arguments.length-2;a++){if(arguments[a]===undefined)c[a]=undefined}})}if(this._0&&this._0.captureNames){for(var d=1;d<c.length;d++){e=this._0.captureNames[d-1];if(e)c[e]=c[d]}}if(!s&&this.global&&!c[0].length&&(this.lastIndex>c.index))this.lastIndex--}return c};if(!s){RegExp.prototype.test=function(a){var b=i.exec.call(this,a);if(b&&this.global&&!b[0].length&&(this.lastIndex>b.index))this.lastIndex--;return!!b}}String.prototype.match=function(a){if(!XRegExp.isRegExp(a))a=RegExp(a);if(a.global){var b=i.match.apply(this,arguments);a.lastIndex=0;return b}return a.exec(this)};String.prototype.replace=function(g,h){var k=XRegExp.isRegExp(g),j,l,v;if(k&&typeof h.valueOf()==="string"&&h.indexOf("${")===-1&&A)return i.replace.apply(this,arguments);if(!k)g=g+"";else if(g._0)j=g._0.captureNames;if(typeof h==="function"){l=i.replace.call(this,g,function(){if(j){arguments[0]=new String(arguments[0]);for(var a=0;a<j.length;a++){if(j[a])arguments[0][j[a]]=arguments[a+1]}}if(k&&g.global)g.lastIndex=arguments[arguments.length-2]+arguments[0].length;return h.apply(null,arguments)})}else{v=this+"";l=i.replace.call(v,g,function(){var d=arguments;return i.replace.call(h,y,function(a,b,c){if(b){switch(b){case"$":return"$";case"&":return d[0];case"`":return d[d.length-1].slice(0,d[d.length-2]);case"'":return d[d.length-1].slice(d[d.length-2]+d[0].length);default:var e="";b=+b;if(!b)return a;while(b>d.length-3){e=String.prototype.slice.call(b,-1)+e;b=Math.floor(b/10)}return(b?d[b]||"":"$")+e}}else{var f=+c;if(f<=d.length-3)return d[f];f=j?q(j,c):-1;return f>-1?d[f+1]:a}})})}if(k&&g.global)g.lastIndex=0;return l};String.prototype.split=function(a,b){if(!XRegExp.isRegExp(a))return i.split.apply(this,arguments);var c=this+"",e=[],f=0,d,g;if(b===undefined||+b<0){b=Infinity}else{b=Math.floor(+b);if(!b)return[]}a=XRegExp.copyAsGlobal(a);while(d=a.exec(c)){if(a.lastIndex>f){e.push(c.slice(f,d.index));if(d.length>1&&d.index<c.length)Array.prototype.push.apply(e,d.slice(1));g=d[0].length;f=a.lastIndex;if(e.length>=b)break}if(a.lastIndex===d.index)a.lastIndex++}if(f===c.length){if(!i.test.call(a,"")||g)e.push("")}else{e.push(c.slice(f))}return e.length>b?e.slice(0,b):e};function m(a,b){if(!XRegExp.isRegExp(a))throw TypeError("type RegExp expected");var c=a._0;a=XRegExp(a.source,u(a)+(b||""));if(c){a._0={source:c.source,captureNames:c.captureNames?c.captureNames.slice(0):null}}return a};function u(a){return(a.global?"g":"")+(a.ignoreCase?"i":"")+(a.multiline?"m":"")+(a.extended?"x":"")+(a.sticky?"y":"")};function w(a,b,c,e){var f=p.length,d,g,h;n=true;try{while(f--){h=p[f];if((c&h.scope)&&(!h.trigger||h.trigger.call(e))){h.pattern.lastIndex=b;g=h.pattern.exec(a);if(g&&g.index===b){d={output:h.handler.call(e,g,c),match:g};break}}}}catch(err){throw err;}finally{n=false}return d};function q(a,b,c){if(Array.prototype.indexOf)return a.indexOf(b,c);for(var e=c||0;e<a.length;e++){if(a[e]===b)return e}return-1};XRegExp.addToken(/\(\?#[^)]*\)/,function(a){return i.test.call(r,a.input.slice(a.index+a[0].length))?"":"(?:)"});XRegExp.addToken(/\((?!\?)/,function(){this.captureNames.push(null);return"("});XRegExp.addToken(/\(\?<([$\w]+)>/,function(a){this.captureNames.push(a[1]);this.hasNamedCapture=true;return"("});XRegExp.addToken(/\\k<([\w$]+)>/,function(a){var b=q(this.captureNames,a[1]);return b>-1?"\\"+(b+1)+(isNaN(a.input.charAt(a.index+a[0].length))?"":"(?:)"):a[0]});XRegExp.addToken(/\[\^?]/,function(a){return a[0]==="[]"?"\\b\\B":"[\\s\\S]"});XRegExp.addToken(/^\(\?([imsx]+)\)/,function(a){this.setFlag(a[1]);return""});XRegExp.addToken(/(?:\s+|#.*)+/,function(a){return i.test.call(r,a.input.slice(a.index+a[0].length))?"":"(?:)"},XRegExp.OUTSIDE_CLASS,function(){return this.hasFlag("x")});XRegExp.addToken(/\./,function(){return"[\\s\\S]"},XRegExp.OUTSIDE_CLASS,function(){return this.hasFlag("s")})})();
